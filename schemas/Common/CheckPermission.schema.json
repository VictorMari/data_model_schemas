{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "CheckPermission.schema.json",
    "title": "CheckPermission",
    "definitions": {
        "CheckPermission": {
            "$id": "#CheckPermission",
            "description": "The CheckPermission task entity verifies that the security principal in context can carry out the action. If permission is granted, 200 is returned, if denied, 403 is returned. If party role or user is present in input, these are used, otherwise the security principal is deduced from the HTTP Authorization header.",
            "type": "object",
            "properties": {
                "entitlement": {
                    "$ref": "Entitlement.schema.json#Entitlement",
                    "description": "Input: the action and function whose permission is being tested",
                    "examples": [
                        "{\"function\":\"ProductOrderItem\",\"action\":\"giveDiscount\"}"
                    ]
                },
                "partyRole": {
                    "$ref": "../EngagedParty/PartyRoleRef.schema.json#PartyRoleRef",
                    "description": "Input: The party role whose permission is being tested, this is preferable to user, since permissions can apply to party roles even when they are not logged into a software system, such as on an IVR, or in a voice call to a service rep"
                },
                "user": {
                    "$ref": "UserinfoRef.schema.json#UserinfoRef",
                    "description": "Input: Information about the security principal whose permission is being tested. Ignored if partyRole is supplied"
                },
                "characteristic": {
                    "type": "array",
                    "items": {
                        "$ref": "Characteristic.schema.json#/definitions/Characteristic"
                    },
                    "description": "Consider defining characteristic spec on Entitlement. Input: Additional information that might be needed for a particular entitlement. For example, if Action is GiveDiscount on Function: ProductOrderItem, a characteristic could be used to transmit the percentage discount being asked for.",
                    "examples": [
                        "{\"name\":\"discountPercentage\",\"value\":10}"
                    ]
                },
                "entity": {
                    "type": "array",
                    "items": {
                        "$ref": "EntityRefOrValue.schema.json#EntityRefOrValue"
                    },
                    "description": "Input: A list of entities for which permission is being tested. For example, if Action is Update and Function is Customer, this could hold reference to specific customer to be updated. Or, if Action is Create and Function is ProductOffering, this could hold the entire entity, so that the permission could be checked against the line of business. Output: A list of entities for which permission is granted"
                }
            },
            "allOf": [
                {
                    "$ref": "../Common/Entity.schema.json#Entity"
                }
            ]
        }
    }
}